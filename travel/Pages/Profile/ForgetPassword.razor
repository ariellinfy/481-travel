@page "/forget"
@layout PageLayout
@inject AuthenticationStateProvider authenticationStateProvider
@inject NavigationManager navigationManager
@inject Blazored.SessionStorage.ISessionStorageService sessionStorage

<PageHeader pageTitle="Forget Password?" />
<hr>
<div class="page-body">
    <p> Don't Worry! We got you covered.</p>
    <p> Just type in your registered email and press submit. Next, we will send you the reset password link to your registered email and by clicking that link, you can reset your password.</p>

    <EditForm Model="user" OnValidSubmit="ValidateInput">
        <DataAnnotationsValidator />
        <div class="input-box">
            <div class="form-floating mt-3">
                <InputText @bind-Value="user.Email" class="form-control" id="email" placeholder="name@example.com" />
                <label for="email">Email</label>
            </div>
            <ValidationMessage For="() => user.Email" />
        </div>
        <div class="form-controls">
            <input type="submit" class="btn btn-primary-filled" value="Submit" />
        </div>
    </EditForm>
</div>

@code {
    private StateModel user;

    protected override void OnInitialized()
    {
        user = new StateModel();
        base.OnInitialized();
    }

    private async Task<bool> ValidateInput()
    {
        ((TravelAuthenticationStateProvider)authenticationStateProvider).NotifyUserAuthentication(user.Email);
        navigationManager.NavigateTo("/");
        await sessionStorage.SetItemAsync("email", user.Email);
        return await Task.FromResult(true);
    }
}